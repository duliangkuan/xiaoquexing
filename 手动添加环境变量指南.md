# 手动添加环境变量指南 📋

## 🔗 访问配置页面

**直接访问**：
**https://vercel.com/duliangkuans-projects/liwu/settings/environment-variables**

## ✅ 需要添加的所有环境变量（7个）

### 重要提示
- **每个变量都要添加到三个环境**：☑️ Production  ☑️ Preview  ☑️ Development
- **所有变量都要勾选三个环境**，否则可能无法正常工作

---

## 📝 详细添加步骤

### 变量1：SMTP_HOST

1. 点击 **"Add New"** 按钮
2. **Key**: `SMTP_HOST`
3. **Value**: `smtp.qq.com`
4. **Environments**: 
   - ☑️ Production
   - ☑️ Preview
   - ☑️ Development
5. 点击 **"Save"**

---

### 变量2：SMTP_PORT

1. 点击 **"Add New"** 按钮
2. **Key**: `SMTP_PORT`
3. **Value**: `465`
4. **Environments**: 
   - ☑️ Production
   - ☑️ Preview
   - ☑️ Development
5. 点击 **"Save"**

---

### 变量3：SMTP_USER

1. 点击 **"Add New"** 按钮
2. **Key**: `SMTP_USER`
3. **Value**: `2330304961@qq.com`
4. **Environments**: 
   - ☑️ Production
   - ☑️ Preview
   - ☑️ Development
5. 点击 **"Save"**

---

### 变量4：SMTP_PASS ⚠️（重要）

1. 点击 **"Add New"** 按钮
2. **Key**: `SMTP_PASS`
3. **Value**: `bwzqgvsfgehwdjde`
4. **Environments**: 
   - ☑️ Production
   - ☑️ Preview
   - ☑️ Development
5. 点击 **"Save"**

**注意**：这是QQ邮箱授权码，不是登录密码！

---

### 变量5：RECIPIENT_EMAIL

1. 点击 **"Add New"** 按钮
2. **Key**: `RECIPIENT_EMAIL`
3. **Value**: `2330304961@qq.com`
4. **Environments**: 
   - ☑️ Production
   - ☑️ Preview
   - ☑️ Development
5. 点击 **"Save"**

---

### 变量6：DIARY_PASSWORD

1. 点击 **"Add New"** 按钮
2. **Key**: `DIARY_PASSWORD`
3. **Value**: `admin888888`
4. **Environments**: 
   - ☑️ Production
   - ☑️ Preview
   - ☑️ Development
5. 点击 **"Save"**

---

### 变量7：DB_NAME（可选）

1. 点击 **"Add New"** 按钮
2. **Key**: `DB_NAME`
3. **Value**: `xiaokuixing_diary`
4. **Environments**: 
   - ☑️ Production
   - ☑️ Preview
   - ☑️ Development
5. 点击 **"Save"**

---

## 📋 快速参考表

| 变量名 | 值 | Production | Preview | Development |
|--------|-----|-----------|---------|-------------|
| `SMTP_HOST` | `smtp.qq.com` | ✅ | ✅ | ✅ |
| `SMTP_PORT` | `465` | ✅ | ✅ | ✅ |
| `SMTP_USER` | `2330304961@qq.com` | ✅ | ✅ | ✅ |
| `SMTP_PASS` | `bwzqgvsfgehwdjde` | ✅ | ✅ | ✅ |
| `RECIPIENT_EMAIL` | `2330304961@qq.com` | ✅ | ✅ | ✅ |
| `DIARY_PASSWORD` | `admin888888` | ✅ | ✅ | ✅ |
| `DB_NAME` | `xiaokuixing_diary` | ✅ | ✅ | ✅ |

**注意**：`MONGODB_URI` 如果已通过Vercel数据库集成连接，会自动创建，无需手动添加。

---

## ✅ 验证配置

添加完所有变量后，页面应该显示类似以下内容：

```
✅ SMTP_HOST = smtp.qq.com (Production, Preview, Development)
✅ SMTP_PORT = 465 (Production, Preview, Development)
✅ SMTP_USER = 2330304961@qq.com (Production, Preview, Development)
✅ SMTP_PASS = *** (Production, Preview, Development)
✅ RECIPIENT_EMAIL = 2330304961@qq.com (Production, Preview, Development)
✅ DIARY_PASSWORD = *** (Production, Preview, Development)
✅ DB_NAME = xiaokuixing_diary (Production, Preview, Development)
```

---

## 🔄 重新部署（必须！）

**重要**：配置完所有环境变量后，必须重新部署才能生效！

### 方法1：在Vercel网站上重新部署

1. 返回项目页面：**https://vercel.com/duliangkuans-projects/liwu**
2. 点击 **"Redeploy"** 按钮（在最新部署旁边）
3. 选择 "Use existing Build Cache" 或直接点击 "Redeploy"
4. 等待部署完成（约2-3分钟）

### 方法2：推送代码触发自动部署

```bash
cd C:\Users\23303\OneDrive\Desktop\liwu
git commit --allow-empty -m "trigger: 触发重新部署以加载环境变量"
git push origin main
```

---

## ⚠️ 常见错误

### 错误1：环境变量没加载

**原因**：配置后没有重新部署

**解决**：
1. 确认所有变量都已添加到所有环境
2. 点击 "Redeploy" 重新部署
3. 等待部署完成

### 错误2：邮件发不出去

**检查清单**：
- ✅ SMTP_HOST 是否正确：`smtp.qq.com`
- ✅ SMTP_PORT 是否正确：`465`
- ✅ SMTP_USER 是否正确：`2330304961@qq.com`
- ✅ SMTP_PASS 是否正确：`bwzqgvsfgehwdjde`（授权码）
- ✅ RECIPIENT_EMAIL 是否正确：`2330304961@qq.com`
- ✅ 所有变量是否添加到所有环境（Production、Preview、Development）
- ✅ 是否已重新部署

### 错误3：授权码错误

**检查**：
- `SMTP_PASS` 的值应该是授权码：`bwzqgvsfgehwdjde`
- 不是QQ邮箱的登录密码
- 授权码在QQ邮箱设置中生成

---

## 🔍 检查环境变量

### 在Vercel网站上检查

访问：**https://vercel.com/duliangkuans-projects/liwu/settings/environment-variables**

应该能看到所有配置的变量及其对应的环境。

### 使用Vercel CLI检查

```bash
cd C:\Users\23303\OneDrive\Desktop\liwu
vercel env ls
```

应该显示所有环境变量的列表。

---

## 📧 测试邮件功能

配置并重新部署后，测试邮件：

1. **访问网站**
2. **点击右下角漂流瓶按钮** 🫧
3. **输入测试内容**（如："这是一封测试邮件"）
4. **点击"倾诉"按钮**
5. **检查邮箱** `2330304961@qq.com` 是否收到邮件

如果收到邮件，说明配置成功！

---

## 🎉 完成！

按照以上步骤添加所有环境变量并重新部署后，邮件功能就能正常工作了！

如有问题，请查看部署日志或联系技术支持。

